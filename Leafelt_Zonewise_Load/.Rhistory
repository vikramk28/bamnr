shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/leaflet-shiny-master/data/uspop.csv")
shiny::runApp()
shiny::runApp()
View(uspop2000)
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/leaflet-shiny-master/data/test_data_japnesh.csv")
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
View(uspop2000)
uspop200 <- read.csv("C:/Users/abc/Desktop/R practice/leaflet-shiny-master/data/test_data_japnesh.csv")
uspop200 <- read.csv("C:/Users/abc/Desktop/R practice/leaflet-shiny-master/data/uspop.csv")
View(uspop200)
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
View(uspop2000)
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
View(uspop2000)
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
View(uspop2000)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
d2 = d1 %>%
group_by(City, Date,	Lat,	Long)
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long)
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long)
d2 = uspop2000 %>%
group_by(City)
d2 = uspop2000
View(`d2`)
d2 = uspop2000 %>%
group_by(City)
d2 = uspop2000 %>%
group_by("City")
library("dplyr", lib.loc="~/R/win-library/3.1")
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long)
View(`d2`)
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(frequencyf=n())
View(`d2`)
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(zone total = sum(Zn0),
sum(Zn1),
sum(Zn2),
sum(Zn3),
sum(Zn4))
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(zone A total = sum(Zn0)
)
d2 = uspop2000
View(`d2`)
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(zone A total = sum(City$Zn0))
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(total = sum(City$Zn0))
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(total = sum(City$Zn0))
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(total = sum(city$Zn0))
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(total = sum(as.integer(city$Zn0)))
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(total = sum(as.integer(City$Zn0)))
d2 = uspop2000 %>%
group_by(City, Date,	Lat,	Long) %>%
summarise(zn0total = sum((Zn0))
View(`d2`)
View(`d2`)
d2 = uspop2000 %>%
group_by(City,	Lat,	Long) %>%
summarise(zn0total = sum((Zn0))
View(`d2`)
View(`d2`)
d2 = uspop2000 %>%
group_by(City,	Lat,	Long) %>%
summarise(zn0total = sum(Zn0))
View(`d2`)
d2 = uspop2000 %>%
group_by(City,	Lat,	Long) %>%
summarise(zn0total = sum(Zn0), Zn B Total=sum(Zn1), Zn C Total = sum(Zn2), Zn D Total= sum(Zn3), Zn E Total = sum(Zn4))
d2 = uspop2000 %>%
group_by(City,	Lat,	Long)
d2 = uspop2000 %>%
group_by(City,	Lat,	Long) %>%
summarise(Zn A Total = sum(Zn0), Zn B Total=sum(Zn1), Zn C Total = sum(Zn2), Zn D Total= sum(Zn3), Zn E Total = sum(Zn4))
d2 = uspop2000 %>%
group_by(City,	Lat,	Long) %>%
summarise(Zn A Total = sum(Zn0), Zn B Total=sum(Zn1), Zn C Total = sum(Zn2), Zn D Total= sum(Zn3), Zn E Total = sum(Zn4))
summarise(Zn A Total = sum(Zn0), Zn B Total=sum(Zn1), Zn C Total = sum(Zn2), Zn D Total= sum(Zn3), Zn E Total = sum(Zn4))
d2 = uspop2000 %>%
group_by(City,	Lat,	Long) %>%
summarise(Zn A Total = sum(Zn0), Zn B Total=sum(Zn1), Zn C Total = sum(Zn2), Zn D Total= sum(Zn3), Zn E Total = sum(Zn4))
d2 = uspop2000 %>%
group_by(City,	Lat,	Long) %>%
summarise(ZnATotal = sum(Zn0), ZnBTotal=sum(Zn1), ZnCTotal = sum(Zn2), ZnDTotal= sum(Zn3), ZnETotal = sum(Zn4))
View(`d2`)
uspop2000 = d2
View(uspop2000)
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
View(uspop2000)
d2 = uspop2000 %>%
group_by(City,  Lat,  Long) %>%
summarise(ZnATotal = sum(Zn0), ZnBTotal=sum(Zn1), ZnCTotal = sum(Zn2), ZnDTotal= sum(Zn3), ZnETotal = sum(Zn4))
uspop2000 = d2
View(`d2`)
View(uspop2000)
View(`d2`)
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
d2 = uspop2000 %>%
group_by(City,  Lat,  Long) %>%
summarise(Zn0 = sum(Zn0), Zn1=sum(Zn1), Zn2 = sum(Zn2), Zn3= sum(Zn3), Zn4 = sum(Zn4))
uspop2000 = d2
View(uspop2000)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
d2 = uspop2000 %>%
group_by(City,  Lat,  Long) %>%
summarise(ZnA = sum(Zn0), ZnB=sum(Zn1), ZnC = sum(Zn2), ZnD= sum(Zn3), ZnE = sum(Zn4))
uspop2000 = d2
View(uspop2000)
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
d2 = uspop2000 %>%
group_by(City,  Lat,  Long) %>%
summarise(Zn0 = sum(Zn0), Zn1=sum(Zn1), Zn2 = sum(Zn2), Zn3= sum(Zn3), Zn4 = sum(Zn4))
uspop2000 = d2
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
d2 = uspop2000 %>%
group_by(City,  Lat,  Long) %>%
summarise(Zn0 = sum(Zn0), Zn1=sum(Zn1), Zn2 = sum(Zn2), Zn3= sum(Zn3), Zn = sum(Zn4))
uspop2000 = d2
View(`d2`)
shiny::runApp()
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
View(uspop2000)
d2 = uspop2000 %>%
group_by(City,  Lat,  Long) %>%
summarise(Zn0 = sum(Zn0), Zn1=sum(Zn1), Zn2 = sum(Zn2), Zn3= sum(Zn3), Zn = sum(Zn4))
View(`d2`)
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
d2 = uspop2000 %>%
group_by(City,  Lat,  Long) %>%
#summarise(Zn0 = sum(Zn0), Zn1=sum(Zn1), Zn2 = sum(Zn2), Zn3= sum(Zn3), Zn4 = sum(Zn4))
summarise(ZnA = sum(Zn0), ZnB=sum(Zn1), ZnC = sum(Zn2), ZnD= sum(Zn3), ZnE = sum(Zn4))
uspop2000 = d2
View(`d2`)
View(uspop2000)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
uspop2000 <- read.csv("C:/Users/abc/Desktop/R practice/r_csv/test_data_japnesh.csv")
View(uspop2000)
d2 = uspop2000 %>%
group_by(Center,  Lat,  Long) %>%
#summarise(Zn0 = sum(Zn0), Zn1=sum(Zn1), Zn2 = sum(Zn2), Zn3= sum(Zn3), Zn4 = sum(Zn4))
summarise(ZnA = sum(Zn0), ZnB=sum(Zn1), ZnC = sum(Zn2), ZnD= sum(Zn3), ZnE = sum(Zn4))
uspop2000 = d2
View(`d2`)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
## Slide 3 - counts according to pt(Forward , Reverse , Cash)
zz_rep_13_10_3 = read.csv("~/R new/zz-rep-13-10-3.csv")
zz_rep_13_10_3_op1 = zz_rep_13_10_3 %>%
mutate(day_3=strftime(strptime(X_id.dl_date ,  "%j") , "%a"),
date_3=strftime(strptime(X_id.dl_date ,  "%j") , "%D")
)
slide_3_min_mon = zz_rep_13_10_3_op1 %>%
filter(day_3=="Sun") %>%
#group_by(dl_count) %>%
summarize(min_mon = min(X_id.dl_date))
slide_3_min_mon = as.integer(slide_3_min_mon)
zz_rep_13_10_3 = read.csv("~/R new/zz-rep-13-10-3.csv")
zz_rep_13_10_3_op1 = zz_rep_13_10_3 %>%
mutate(day_3=strftime(strptime(X_id.dl_date ,  "%j") , "%a"),
date_3=strftime(strptime(X_id.dl_date ,  "%j") , "%D")
)
#Sys.setenv(JAVA_HOME='C:/Program Files/Java/jre7')
#suppressPackageStartupMessages(library(rJava))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(xtable))
suppressPackageStartupMessages(library(reshape))
suppressPackageStartupMessages(library(reshape2))
suppressPackageStartupMessages(library(googleVis))
#suppressPackageStartupMessages(library(ReporteRs))
#library('ReporteRs')
library('googleVis')
op<-options(gvis.plot.tag="chart")
zz_rep_13_10_3 = read.csv("~/R new/zz-rep-13-10-3.csv")
zz_rep_13_10_3_op1 = zz_rep_13_10_3 %>%
mutate(day_3=strftime(strptime(X_id.dl_date ,  "%j") , "%a"),
date_3=strftime(strptime(X_id.dl_date ,  "%j") , "%D")
)
slide_3_min_mon = zz_rep_13_10_3_op1 %>%
filter(day_3=="Sun") %>%
#group_by(dl_count) %>%
summarize(min_mon = min(X_id.dl_date))
slide_3_min_mon = as.integer(slide_3_min_mon)
cl_zn_rep_10_pd=read.csv("~/R new/cl_zn_rep_10_pd.csv")
cl_zn_rep_10_pd_dl3_1 = cl_zn_rep_10_pd%>%
filter(X_id.cl %in% c("HomeShop18" , "HomeShop18-FOS"))%>%
mutate(pd_day = as.integer(strftime(X_id.pd , format="%j")))
cl_zn_rep_10_pd_dl3_2 = cl_zn_rep_10_pd_dl3_1%>%
filter(pd_day>=slide_3_min_mon) %>%
mutate(wkend_dt = (((pd_day -slide_3_min_mon)%/%7)
*7)
+as.integer(slide_3_min_mon)+6)
cl_zn_rep_10_pd_dl3_2$wkend_dt = as.character(cl_zn_rep_10_pd_dl3_2$wkend_dt)
cl_zn_rep_10_pd_dl3_2$wkend_dt= as.POSIXct(cl_zn_rep_10_pd_dl3_2$wkend_dt , format="%j")
cl_zn_rep_10_pd_dl3_3 = cl_zn_rep_10_pd_dl3_2%>%
group_by(wkend_dt , X_id.fddMinusPd)%>%
summarise(sum = sum(dl_count))%>%
mutate(pct = sum*100/sum(sum))%>%
mutate(cumsum = cumsum(pct))%>%
filter(X_id.fddMinusPd<=3)
cl_zn_rep_10_pd_dl3_3 = cl_zn_rep_10_pd_dl3_3%>%
dcast(X_id.fddMinusPd~wkend_dt,value.var="cumsum")%>%
dplyr::rename(Speed = X_id.fddMinusPd)
cl_cs_pt_rep_13_10_3_zn = read.csv("~/R new/cl-cs-pt-rep-13-10-3-zn.csv")
cl_rr_3_1 = cl_cs_pt_rep_13_10_3_zn%>%
filter(X_id.dl_date>=slide_3_min_mon ,
X_id.cl %in% c("HomeShop18" , "HomeShop18-FOS"),
X_id.dl_pt %in% c("COD" , "Pre-paid")) %>%
mutate(wkend_dt = (((as.numeric(X_id.dl_date) -slide_3_min_mon)%/%7)
*7)
+as.integer(slide_3_min_mon)+6 ,
Status = ifelse(X_id.dl_cs_ss %in% c("RTO" , "Returned") , "RTO" , "Other")
)
cl_rr_3_1$wkend_dt = as.character(cl_rr_3_1$wkend_dt)
cl_rr_3_1$wkend_dt = as.POSIXct(cl_rr_3_1$wkend_dt , format="%j")
cl_rr_3_2 = cl_rr_3_1 %>%
group_by( wkend_dt , Status)%>%
summarize(sum = sum(as.numeric(dl_count)))%>%
mutate(pct=100*sum/sum(sum)) %>%
filter(Status=="RTO")
cl_rr_3_3 = cl_rr_3_2 %>%
mutate(pct = paste(as.numeric(round(pct , 1)),"%")) %>%
dcast(Status~wkend_dt  ,value.var="pct")
cl_cs_pt_rep_13_10_3_zn = read.csv("~/R new/cl-cs-pt-rep-13-10-3-zn.csv")
cl_rr_3_1 = cl_cs_pt_rep_13_10_3_zn%>%
filter(X_id.dl_date>=slide_3_min_mon ,  X_id.cl %in% c("HomeShop18" , "HomeShop18-FOS"),
X_id.dl_pt %in% c("COD" , "Pre-paid")) %>%
mutate(wkend_dt = (((as.numeric(X_id.dl_date) -slide_3_min_mon)%/%7)
*7)
+as.integer(slide_3_min_mon)+6 ,
Status = ifelse(X_id.dl_cs_ss=="Delivered" , "Delivered" , "Other")
)
cl_rr_3_1$wkend_dt = as.character(cl_rr_3_1$wkend_dt)
cl_rr_3_1$wkend_dt = as.POSIXct(cl_rr_3_1$wkend_dt , format="%j")
cl_rr_3_22 = cl_rr_3_1 %>%
group_by( wkend_dt , Status)%>%
summarize(sum = sum(as.numeric(dl_count)))%>%
mutate(pct=100*sum/sum(sum)) %>%
filter(Status=="Delivered")
cl_rr_3_24 = cl_rr_3_22 %>%
mutate(pct = paste(as.numeric(round(pct , 1)),"%")) %>%
dcast(Status~wkend_dt  ,value.var="pct")
cl_zn_rep_10_pd=read.csv("~/R new/cl_zn_rep_10_pd.csv")
cl_zn_rep_10_pd_cl31 = cl_zn_rep_10_pd%>%
filter(X_id.zn=="A" , X_id.cl %in% c("HomeShop18" , "HomeShop18-FOS") )%>%
mutate(pd_hr = as.numeric(strftime(X_id.pd , "%H"))
,
pd_day = as.integer(strftime(X_id.pd , format="%j")))
cl_zn_rep_10_pd_cl31 = cl_zn_rep_10_pd_cl31%>%
filter(pd_hr<8)%>%
mutate(sdd_flag = ifelse(X_id.fddMinusPd==0,1,0
))
cl_zn_rep_10_pd_cl31 = cl_zn_rep_10_pd_cl31%>%
filter(pd_day>=slide_3_min_mon) %>%
mutate(wkend_dt = (((pd_day -slide_3_min_mon)%/%7)
*7)
+as.integer(slide_3_min_mon)+6)
cl_zn_rep_10_pd_cl31$wkend_dt = as.character(cl_zn_rep_10_pd_cl31$wkend_dt)
cl_zn_rep_10_pd_cl31$wkend_dt= as.POSIXct(cl_zn_rep_10_pd_cl31$wkend_dt , format="%j")
cl_zn_rep_10_pd_cl32 = cl_zn_rep_10_pd_cl31%>%
group_by( wkend_dt , sdd_flag )%>%
summarize(sum = sum(as.numeric(dl_count)))%>%
mutate(pct=100*sum/sum(sum))
cl_zn_rep_10_pd_cl33 = cl_zn_rep_10_pd_cl32%>%
mutate(pct = paste(as.numeric(round(pct , 1)),"%")) %>%
dcast(sdd_flag~wkend_dt  ,value.var="pct")%>%
filter(sdd_flag==0)
cl_zn_rep_10_pd=read.csv("~/R new/cl_zn_rep_10_pd.csv")
cl_zn_rep_10_pd_cl31 = cl_zn_rep_10_pd%>%
filter(X_id.zn %in% c("B" , "C") ,  X_id.cl %in% c("HomeShop18" , "HomeShop18-FOS"))%>%
mutate(pd_hr = as.numeric(strftime(X_id.pd , "%H"))
,
pd_day = as.integer(strftime(X_id.pd , format="%j")))
cl_zn_rep_10_pd_cl31 = cl_zn_rep_10_pd_cl31%>%
filter(pd_hr<16)%>%
mutate(ndd_flag = ifelse(X_id.fddMinusPd<2,1,0
))
cl_zn_rep_10_pd_cl31 = cl_zn_rep_10_pd_cl31%>%
filter(pd_day>=slide_3_min_mon) %>%
mutate(wkend_dt = (((pd_day -slide_3_min_mon)%/%7)
*7)
+as.integer(slide_3_min_mon)+6)
cl_zn_rep_10_pd_cl31$wkend_dt = as.character(cl_zn_rep_10_pd_cl31$wkend_dt)
cl_zn_rep_10_pd_cl31$wkend_dt= as.POSIXct(cl_zn_rep_10_pd_cl31$wkend_dt , format="%j")
cl_zn_rep_10_pd_cl32 = cl_zn_rep_10_pd_cl31%>%
group_by( wkend_dt , ndd_flag )%>%
summarize(sum = sum(as.numeric(dl_count)))%>%
mutate(pct=100*sum/sum(sum))
cl_zn_rep_10_pd_cl313 = cl_zn_rep_10_pd_cl32%>%
mutate(pct = paste(as.numeric(round(pct , 1)),"%")) %>%
dcast(ndd_flag~wkend_dt  ,value.var="pct")%>%
filter(ndd_flag==0)
